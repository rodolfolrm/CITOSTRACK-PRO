:root{
  --primary:#0d47a1;
  --primary-2:#1976d2;
  --ink:#222;
  --bg:#f6f8fb;
  --muted:#5f6b7a;
  --ok:#2e7d32;
  --danger:#c62828;
  --ring: rgba(25,118,210,.25);
  --border:#e3e7ee;
}
*{ box-sizing:border-box }
html,body{ height:100% }
body{
  margin:0; font-family:"Segoe UI", Roboto, system-ui, -apple-system, Arial, sans-serif;
  color:var(--ink); background:var(--bg);
}

/* ======== APP BAR ======== */
.appbar{ background:var(--primary); color:#fff; box-shadow:0 2px 6px rgba(0,0,0,.16) }
.appbar-inner{
  max-width:1200px; margin:0 auto; padding:12px 20px;
  display:flex; align-items:center; justify-content:space-between; gap:16px;
}
.brand{ display:flex; align-items:center; gap:14px }
.logoPreview{
  width:96px; height:96px; object-fit:contain; border-radius:6px;
  background:#fff; border:1px solid #ddd;
}
.brand h1{ margin:0; font-size:20px; letter-spacing:.2px }
.brand small{ display:block; margin-top:2px; font-size:12px; color:#cfe6ff }
.uploader{ font-size:12px; color:#cfe6ff; text-decoration:underline; cursor:pointer }
.actions .btn{ margin-left:8px }

/* ======== LAYOUT ======== */
.container{ max-width:1200px; margin:18px auto; padding:0 20px }
.card{
  background:#fff; border-radius:10px; overflow:hidden;
  box-shadow:0 2px 8px rgba(0,0,0,.08);
}
.card-header{
  display:flex; align-items:center; justify-content:space-between; gap:12px;
  padding:12px 16px; background:var(--primary-2); color:#fff;
}
.card-title{ margin:0; font-size:18px; font-weight:600 }

.table-wrap{ overflow:auto }
table{ width:100%; border-collapse:collapse; }
th, td{
  border-bottom:1px solid var(--border);
  padding:10px 8px; text-align:center; font-size:14px; line-height:1.25;
  word-break:break-word;
}
th{ background:#eaf2ff; font-weight:700 }
tbody tr:nth-child(odd){ background:#fbfdff }
tfoot td{ background:#eef1f4; font-weight:700 }

td[contenteditable="true"]{ outline:none; border-radius:4px; }
td[contenteditable="true"]:focus{ box-shadow:0 0 0 3px var(--ring); }

.hint{ margin:0; padding:12px 16px; color:var(--muted); font-size:13px }

/* ======== BOTONES ======== */
.btn{
  border:none; cursor:pointer; padding:8px 12px; border-radius:8px; font-weight:600;
  transition:transform .03s ease, opacity .15s ease;
}
.btn:active{ transform:translateY(1px) }
.btn.alt{ background:var(--primary-2); color:#fff }
.btn.ghost{ background:transparent; border:1px solid #fff; color:#fff }
.btn.ok{ background:var(--ok); color:#fff }
.btn.danger{ background:var(--danger); color:#fff }
.btn.flat{ background:#eef4ff; color:#0b3b85; border:1px solid #cfe0ff }

/* ======== REPORTE (PDF profesional) ======== */
#report{
  display:none; padding:0 16mm 12mm 16mm; color:#111;
  font-size:11px; line-height:1.25;
  font-variant-numeric: tabular-nums lining-nums;
}
#report header{
  display:flex; align-items:flex-start; gap:12px;
  border-bottom:2px solid #dfe3ea; padding:0 0 6mm 0; margin-bottom:4mm;
}
#report header img{
  width:72px; height:72px; object-fit:contain; background:#fff; border:1px solid #dcdcdc; border-radius:6px
}
#report header h2{ margin:0; font-size:16px; letter-spacing:.2px }
#report header p{ margin:1mm 0 0 0; font-size:11px; color:#444 }
#report .meta{ margin-left:auto; text-align:right; font-size:10.5px; color:#444 }

/* KPIs */
#report .kpis{
  display:grid; grid-template-columns: repeat(4, 1fr); gap:6px; margin:2mm 0 4mm;
}
#report .k{
  border:1px solid #e6eaf1; border-radius:8px; padding:6px 8px; background:#fbfcff;
}
#report .k .l{ font-size:10px; color:#666 }
#report .k .v{ font-size:13px; font-weight:700 }

/* Tabla de reporte */
#report table{ width:100%; border-collapse:collapse; }
#report th, #report td{
  border:1px solid #dfe3ea; padding:4.5px 4px; vertical-align:middle;
  line-height:1.15;
}
#report th{
  background:#f4f7ff; font-size:11px; font-weight:700;
}
#report td{ font-size:10.5px; }
#report tfoot td{ background:#f2f4f6; font-weight:700 }

/* Ajusta anchos aquí (colgroup) */
#report colgroup col.c-nombre{ width:24% }
#report colgroup col.c-rut   { width:12% }
#report colgroup col.c-fecha { width:10% }
#report colgroup col.c-sem   { width:6%  }
#report colgroup col.c-prep  { width:8%  }
#report colgroup col.c-adm   { width:8%  }
#report colgroup col.c-min   { width:8%  }
#report colgroup col.c-icc   { width:6%  }
#report colgroup col.c-obs   { width:18% }

/* Alineaciones */
.t-left{ text-align:left }
.t-center{ text-align:center }
.t-right{ text-align:right }
.nowrap{ white-space:nowrap }
.wrap{ white-space:normal; hyphens:auto }

/* Evitar cortes feos en impresión */
#report thead{ display:table-header-group }
#report tfoot{ display:table-footer-group }
#report tr, #report td, #report th{ page-break-inside:avoid; break-inside:avoid }

/* ======== PRINT ======== */
@media print{
  @page{ size:letter portrait; margin:14mm }
  body{ background:#fff }
  .appbar, .container, .hint, .actions-screen{ display:none !important }
  #report{ display:block }
}
